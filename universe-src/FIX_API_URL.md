# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ ERR_NAME_NOT_RESOLVED –¥–ª—è api.civilx.ru

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—ã—Ç–∞–µ—Ç—Å—è –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ `api.civilx.ru`, –Ω–æ –¥–æ–º–µ–Ω –Ω–µ —Ä–µ–∑–æ–ª–≤–∏—Ç—Å—è (ERR_NAME_NOT_RESOLVED).

## –ü—Ä–∏—á–∏–Ω–∞

–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `NEXT_PUBLIC_API_URL` –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ JavaScript –∫–æ–¥ **–≤–æ –≤—Ä–µ–º—è —Å–±–æ—Ä–∫–∏**, –∞ –Ω–µ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –ü–æ—ç—Ç–æ–º—É –∏–∑–º–µ–Ω–µ–Ω–∏–µ –µ—ë –≤ `.env` –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω–µ –ø–æ–º–æ–∂–µ—Ç.

## –†–µ—à–µ–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: API –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ IP –∞–¥—Ä–µ—Å—É –∏–ª–∏ –¥—Ä—É–≥–æ–º—É –¥–æ–º–µ–Ω—É

–ï—Å–ª–∏ API —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –¥—Ä—É–≥–æ–º—É –∞–¥—Ä–µ—Å—É, –Ω—É–∂–Ω–æ **–ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑** —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º URL:

```bash
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
cd C:\Projects\CivilX\Site\civilx-website\universe\universe

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º API URL
docker build --build-arg NEXT_PUBLIC_API_URL=http://IP_–ê–î–†–ï–°:8000/api/datalab -t civilx-universe:latest .

# –ò–ª–∏ –µ—Å–ª–∏ API –Ω–∞ —Ç–æ–º –∂–µ —Å–µ—Ä–≤–µ—Ä–µ
docker build --build-arg NEXT_PUBLIC_API_URL=http://95.163.230.61:8000/api/datalab -t civilx-universe:latest .

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞ GitHub
docker tag civilx-universe:latest ghcr.io/f1bonacci66/civilx-universe:latest
docker push ghcr.io/f1bonacci66/civilx-universe:latest
```

–ó–∞—Ç–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
```bash
cd /opt/civilx-universe
docker-compose pull
docker-compose up -d
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: API –Ω–∞ —Ç–æ–º –∂–µ —Å–µ—Ä–≤–µ—Ä–µ (localhost)

–ï—Å–ª–∏ API –∑–∞–ø—É—â–µ–Ω –Ω–∞ —Ç–æ–º –∂–µ —Å–µ—Ä–≤–µ—Ä–µ, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Next.js:

```bash
# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ —Å localhost
docker build --build-arg NEXT_PUBLIC_API_URL=http://localhost:8000/api/datalab -t civilx-universe:latest .
```

–ù–æ —ç—Ç–æ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç, –µ—Å–ª–∏ API –≤ –¥—Ä—É–≥–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–º—è —Å–µ—Ä–≤–∏—Å–∞ Docker –∏–ª–∏ IP.

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å DNS –∏–ª–∏ hosts —Ñ–∞–π–ª

–ï—Å–ª–∏ API —Å–µ—Ä–≤–µ—Ä —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –¥–æ–º–µ–Ω –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω:

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ /etc/hosts
echo "IP_–ê–î–†–ï–°_API api.civilx.ru" | sudo tee -a /etc/hosts
```

–ù–æ —ç—Ç–æ –Ω–µ –ø–æ–º–æ–∂–µ—Ç, —Ç–∞–∫ –∫–∞–∫ –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞ –∫–ª–∏–µ–Ω—Ç–∞, –∞ –Ω–µ —Å —Å–µ—Ä–≤–µ—Ä–∞.

### –í–∞—Ä–∏–∞–Ω—Ç 4: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Nginx reverse proxy

–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Nginx –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API:

```nginx
# /etc/nginx/sites-available/api.civilx.ru
server {
    listen 80;
    server_name api.civilx.ru;

    location / {
        proxy_pass http://IP_–ê–î–†–ï–°_API:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –¥–æ—Å—Ç—É–ø–µ–Ω –ª–∏ API:

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
curl http://localhost:8000/api/datalab/health
# –∏–ª–∏
curl http://95.163.230.61:8000/api/datalab/health
# –∏–ª–∏
curl https://api.civilx.ru/api/datalab/health
```

## –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (mock –¥–∞–Ω–Ω—ã–µ)

–ï—Å–ª–∏ API –µ—â–µ –Ω–µ –≥–æ—Ç–æ–≤, –º–æ–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å mock –¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–¥–µ.

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

1. –£–∑–Ω–∞–π—Ç–µ, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è API —Å–µ—Ä–≤–µ—Ä
2. –ï—Å–ª–∏ API –¥–æ—Å—Ç—É–ø–µ–Ω - –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º URL
3. –ï—Å–ª–∏ API –µ—â–µ –Ω–µ –≥–æ—Ç–æ–≤ - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ mock –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ API




